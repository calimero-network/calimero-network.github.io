---
id: ethereum-wallet
title: Ethereum Wallet
---

## Logging in with Ethereum Wallet

Calimero allows users to authenticate via their Ethereum wallet (such as
Metamask), ensuring secure access to the Admin Dashboard. The authentication
process leverages Ethereum's ECDSA signature verification through smart
contracts deployed on the Ethereum network.

## Authentication Flow

The Ethereum authentication in Calimero follows a smart contract-based approach
rather than a traditional challenge-response pattern. Here's how it works:

### 1. User Initiates Login

- The user navigates to the Admin Dashboard and selects the option to "Login
  with Ethereum Wallet."
- They are presented with wallet options, typically Metamask or other Web3
  wallet extensions.

### 2. Wallet Connection

- The user connects their Ethereum wallet (e.g., Metamask) to the Calimero
  application.
- The wallet extension prompts the user to approve the connection and select the
  desired account.
- The user's Ethereum address is retrieved from the connected wallet.

### 3. Request Preparation

Instead of a server-generated challenge, Calimero uses a structured request
format that includes:

```solidity
struct Request {
    bytes32 signerId;    // ECDSA public key (Ethereum address)
    bytes32 userId;       // Ed25519 public key
    uint64 nonce;         // Unique request identifier
    RequestKind kind;     // Type of operation
    bytes data;           // Operation-specific data
}
```

### 4. User Signs Request

- The user is prompted to sign the structured request using their Ethereum
  wallet.
- The wallet extension displays the request data and requests user confirmation.
- The user approves the signature request in their wallet.

### 5. Signature Verification

The backend verifies the Ethereum signature using the smart contract's
verification logic:

1. **Message Hash Creation**:

   ```solidity
   bytes32 messageHash = keccak256(abi.encode(request));
   ```

2. **Ethereum Signed Message Hash**:

   ```solidity
   bytes32 ethSignedMessageHash = keccak256(
       abi.encodePacked("\x19Ethereum Signed Message:\n32", messageHash)
   );
   ```

3. **Signature Recovery and Verification**:
   ```solidity
   address signer = ecrecover(ethSignedMessageHash, v, r, s);
   if (signer == address(0) || bytes32(uint256(uint160(signer))) != request.signerId) {
       revert InvalidSignature();
   }
   ```

### 6. Successful Authentication

- Once verified through the smart contract, the user is successfully
  authenticated.
- Their Ethereum address serves as their identifier for blockchain operations
  and context management.

## Smart Contract Integration

Calimero's Ethereum authentication is built on two main smart contracts:

- **Context Config Contract**: Manages context creation and member management
- **Context Proxy Contract**: Handles cross-contract calls and state management

These contracts are deployed on the Ethereum network (including testnets like
Sepolia) and provide the foundation for secure, decentralized authentication.

## Supported Ethereum Wallets

Calimero supports various Ethereum-compatible wallets:

- **Metamask**: The most popular Web3 wallet extension
- **WalletConnect**: For mobile wallet connections
- **Other Web3 Wallets**: Any wallet that supports the standard Ethereum signing
  interface

## Network Support

Ethereum wallet authentication works across multiple Ethereum networks:

- **Ethereum Mainnet**: Production network
- **Ethereum Testnets**: Sepolia, Goerli, and other test networks
- **Ethereum Layer 2s**: Polygon, Arbitrum, Optimism, and other L2 solutions
- **Ethereum-compatible chains**: BSC, Avalanche C-Chain, and other
  EVM-compatible networks

## Security Features

- **Smart Contract Verification**: All authentication is verified on-chain
  through deployed smart contracts
- **ECDSA Signature Verification**: Uses Ethereum's standard cryptographic
  methods for signature validation
- **Nonce-based Requests**: Each request includes a unique nonce to prevent
  replay attacks
- **Address-based Identity**: User identity is tied to their Ethereum address,
  ensuring decentralized authentication

This authentication flow leverages Ethereum's robust smart contract
infrastructure and ECDSA signature verification to provide secure, decentralized
access to Calimero's features while maintaining consistency with the
blockchain's native security model.
